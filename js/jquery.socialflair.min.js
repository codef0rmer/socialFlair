/*!
 * jQuery socialFlair - Stackoverflow like User Flairs to showcase your 
 * Social Profiles
 * ---------------------------------------------------------------------
 *
 * This is a simple jQuery plugin which lets you embed social flairs 
 * into your personal website or blog.
 *
 * Licensed under Mozilla Public License
 *
 * @version        1.0.0
 * @since          2012.05.01
 * @author         Amit Gharat a.k.a. codef0rmer
 * @blog           http://goo.gl/frl5a
 * @twitter        twitter.com/codef0rmer
 *
 * Usage:
 * ---------------------------------------------------------------------
 * Twitter Flair: 
 *    $(ele).socialFlair('twitter', 'twitterUsername', {});
 * 
 * Github Flair:
 *    $(ele).socialFlair('github', 'githubUsername', {});
 * 
 * Facebook Flair:
 *    Create an App and get the details here: https://developers.facebook.com/apps
 *    $(ele).socialFlair('facebook', 'facebookUsername', {clientId : clientId, clientSecret : clientSecrete});
 *
 */
function truncateName(a){return a.length>28?a.substring(0,28)+"...":a}(function(a){a.fn.extend({socialFlair:function(b,c,d){var e={};var d=a.extend({},e,d);return this.each(function(){var e=a(this),f=0,g=0,h=null,i=0;if(b==="twitter"&&c!==undefined){a(document).queue("ajaxRequests",function(){a.ajax({url:"http://api.twitter.com/1/followers/ids.json?screen_name="+c+"&cursor=-1",method:"get",dataType:"jsonp",success:function(a){f=a.ids.length}})});a(document).queue("ajaxRequests",function(){a.ajax({url:"https://api.twitter.com/1/friends/ids.json?cursor=-1&screen_name="+c,method:"get",dataType:"jsonp",success:function(a){g=a.ids.length;e.html("<a class='sfLink' href='http://twitter.com/#!/"+c+"'><div class='sfTable sfTwitter'><div class='sfRow'>"+" <div class='sfCell1'>"+"  <img class='sfProfilePic' src='https://api.twitter.com/1/users/profile_image?screen_name="+c+"&size=normal' width='48px' height='48px' />"+" </div>"+" <div class='sfCell2'>"+"  <div class='sfHandle'>"+truncateName(c)+"</div>"+"  <div class='sfFans'>"+"\t <span class='following' alt='Following' title='Following'>"+g+"</span>"+" \t <span class='followers' alt='Followers' title='Followers'>"+f+"</span>"+"  </div>"+"</div>"+"</div></div>​</a>")}})});a(document).dequeue("ajaxRequests");a(document).dequeue("ajaxRequests")}else if(b==="github"&&c!==undefined){a.ajax({url:"https://api.github.com/users/"+c,method:"get",dataType:"jsonp",success:function(a){f=a.data.followers;i=a.data.public_repos;e.html("<a class='sfLink' href='"+a.data.html_url+"'><div class='sfTable sfGithub'><div class='sfRow'>"+" <div class='sfCell1'>"+"  <img class='sfProfilePic' src='"+a.data.avatar_url+"' width='48px' height='48px' />"+" </div>"+" <div class='sfCell2'>"+"  <div class='sfHandle'>"+truncateName(a.data.name)+"</div>"+"  <div class='sfFans'>"+"\t <span class='public_repos' alt='Public Repositories' title='Public Repositories'>"+i+"</span>"+" \t <span class='followers' alt='Followers' title='Followers'>"+f+"</span>"+(a.data.hireable===true?"<span class='hireable'>Hire Me!</span>":"")+"  </div>"+"</div>"+"</div></div>​</a>")}})}else if(b==="facebook"&&c!==undefined){a.ajax({url:"https://graph.facebook.com/oauth/access_token?client_id="+d.clientId+"&client_secret="+d.clientSecret+"&grant_type=client_credentials",method:"get",dataType:"text",success:function(b){h=b;a.ajax({url:"https://api.facebook.com/method/friends.get?uid="+c+"&"+h+"&format=json",method:"get",dataType:"jsonp",success:function(b){g=b.length;a.ajax({url:"https://graph.facebook.com/"+c,method:"get",dataType:"jsonp",success:function(a){e.html("<a class='sfLink' href='"+a.link+"'><div class='sfTable sfFacebook'><div class='sfRow'>"+" <div class='sfCell1'>"+"  <img class='sfProfilePic' src='http://graph.facebook.com/"+c+"/picture' width='48px' height='48px' />"+" </div>"+" <div class='sfCell2'>"+"  <div class='sfHandle'>"+truncateName(a.name)+"</div>"+"  <div class='sfFans'>"+"\t <span class='following' alt='Friends' title='Friends'>"+g+"</span>"+"  </div>"+"</div>"+"</div></div>​</a>")}})}})}})}})}})})(jQuery)
